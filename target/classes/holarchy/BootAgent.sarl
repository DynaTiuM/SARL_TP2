/** 
 * 
 */
package holarchy

import io.sarl.api.core.Initialize
import io.sarl.api.core.Lifecycle
import io.sarl.api.core.Logging
import ui.SearchManagerGUI
import java.util.concurrent.ConcurrentLinkedQueue
import java.io.File

interface SearchManagerCallback {
  def onSearch(path: String, criteria: String)
}

interface SearchResultCallback {
	def onSearchCompleted(foundFiles : ConcurrentLinkedQueue<File>)
}

agent BootAgent {
	uses Logging, Lifecycle
	
	var ui: SearchManagerGUI

	val searchManagerCallback = new SearchManagerCallback {
		def onSearch(path : String, criteria : String) {
			val resultListener = new SearchResultCallback {
				def onSearchCompleted(foundFiles: ConcurrentLinkedQueue<File>) {
					ui.updateResults(foundFiles)
				}
			}
			spawn(SearchManager, path, criteria, resultListener)
		}
	}

	on Initialize {
		ui = new SearchManagerGUI(searchManagerCallback)
		loggingName = "Boot"
	}
}
